<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ©Ÿæœƒè©³æƒ…</title>
    <link rel="stylesheet" href="/styles/main.css">
    <link rel="stylesheet" href="/styles/modules/variables.css">
    <link rel="stylesheet" href="/styles/modules/components.css">
    <link rel="stylesheet" href="/styles/modals.css">

    <style>
        /* ã€æœ€çµ‚ä¿®æ­£ã€‘å¼·åˆ¶ç¢ºä¿ widget-content åŠå…¶å…§å®¹å¯è¦‹ */
        #opp-potential-contacts-container.widget-content {
            display: block !important;
            flex-grow: initial !important;
            min-height: 50px; /* çµ¦äºˆä¸€å€‹æœ€å°é«˜åº¦ä»¥ç¢ºä¿å®¹å™¨ä¸æœƒå¡Œé™· */
        }

        /* æ–°å¢çš„å­é ç±¤æ¨£å¼ */
        .sub-tabs {
            display: flex;
            border-bottom: 2px solid var(--border-color);
            margin-bottom: var(--spacing-5);
        }
        .sub-tab-link {
            padding: var(--spacing-3) var(--spacing-4);
            cursor: pointer;
            color: var(--text-muted);
            border: none;
            background: none;
            border-bottom: 3px solid transparent;
            margin-bottom: -2px; /* è®“ active çš„ border è“‹éåº•ç·š */
            transition: all 0.2s ease;
            
            font-size: var(--font-size-base); /* 1rem */
            font-weight: 700; /* åŠ ç²— */
        }
        
        .sub-tab-link.active {
            color: var(--accent-blue);
            border-bottom-color: var(--accent-blue);
            /* ä½¿ç”¨ color-mix ç”¢ç”Ÿ 20% é€æ˜åº¦çš„ accent-blue */
            background-color: color-mix(in srgb, var(--accent-blue) 20%, transparent); 
            border-radius: var(--rounded-md) var(--rounded-md) 0 0; /* é ‚éƒ¨åœ“è§’ */
        }

        .sub-tab-link:hover {
            color: var(--text-primary);
            /* Hover ä½¿ç”¨ 15% é€æ˜åº¦ï¼Œæ¯” active ç•¥æ·¡ */
            background-color: color-mix(in srgb, var(--accent-blue) 15%, transparent); 
            border-radius: var(--rounded-md) var(--rounded-md) 0 0; /* åŒæ¨£è¿½åŠ åœ“è§’ */
            border-bottom-color: var(--border-color); /* çµ¦ hover ä¸€å€‹åº•ç·š */
        }
        
        .sub-tab-content {
            display: none;
        }
        .sub-tab-content.active {
            display: block;
        }
    </style>
</head>
<body>

    <div id="opportunity-detail-container" style="padding: 20px;">

        <div id="opportunity-info-card-container" class="opportunity-info-card" style="margin-bottom: var(--spacing-6);">
            </div>

        <div id="opportunity-stage-stepper-container" class="dashboard-widget" style="margin-bottom: var(--spacing-6);">
            <div class="widget-header" style="margin-bottom: 0;">
                <h2 class="widget-title">æ©Ÿæœƒé€²ç¨‹</h2>
            </div>
            <div id="opportunity-stage-stepper" class="widget-content">
                </div>
        </div>

        <div id="tab-content-events" class="tab-content active" style="margin-bottom: var(--spacing-6);">
             </div>

        <div id="tab-content-interactions" class="tab-content active" style="margin-bottom: var(--spacing-6);">
            <div class="interaction-layout">
                
                <div class="interaction-history-section">
        
                    <div class="sub-tabs">
                        <button class="sub-tab-link active" data-tab="discussion">å‹•æ…‹ç‰†</button>
                        <button class="sub-tab-link" data-tab="activity">ç³»çµ±æ´»å‹•ç´€éŒ„</button>
                    </div>
                
                    <div id="discussion-pane" class="sub-tab-content active">
                        <div id="discussion-timeline" class="interaction-timeline">
                            </div>
                    </div>
                    <div id="activity-pane" class="sub-tab-content">
                        <div id="activity-log-timeline" class="interaction-timeline">
                            </div>
                    </div>
                
                </div>

                <div class="interaction-form-section">
                    <h3 style="margin-bottom: 1.5rem;">æ–°å¢/ç·¨è¼¯äº’å‹•</h3>
                    <form id="new-interaction-form">
                        <input type="hidden" id="interaction-opportunity-id">
                        <input type="hidden" id="interaction-edit-rowIndex">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">äº’å‹•é¡å‹</label>
                                <div class="select-wrapper">
                                    <select class="form-select" id="interaction-event-type" required></select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">äº’å‹•æ™‚é–“</label>
                                <input type="datetime-local" class="form-input" id="interaction-time" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">å…§å®¹æ‘˜è¦ *</label>
                            <textarea class="form-textarea" id="interaction-summary" placeholder="è¨˜éŒ„äº’å‹•é‡é»..." required></textarea>
                        </div>
                         <div class="form-group">
                            <label class="form-label">ä¸‹æ¬¡è¡Œå‹•</label>
                            <input type="text" class="form-input" id="interaction-next-action" placeholder="æº–å‚™å ±åƒ¹å–®ä¸¦æ–¼ä¸‹é€±ä¸‰å‰å¯„å‡º..."></input>
                        </div>
                        <button type="submit" class="submit-btn" id="interaction-submit-btn">ğŸ’¾ æ–°å¢ç´€éŒ„</button>
                    </form>
                </div>
            </div>
        </div>

        <div class="dashboard-widget" style="margin-top: var(--spacing-6);">
            <div class="widget-header">
                <h2 class="widget-title">é—œè¯è¯çµ¡äºº</h2>
                <button class="action-btn primary" id="add-associated-contact-btn">+ é—œè¯è¯çµ¡äºº</button>
            </div>
            <div id="associated-contacts-list" class="widget-content">
                </div>
        </div>

        <div class="dashboard-widget" style="margin-top: var(--spacing-6);">
            <div class="widget-header">
                <h2 class="widget-title">é—œè¯æ©Ÿæœƒ</h2>
                <button class="action-btn primary" id="add-associated-opportunity-btn">+ é—œè¯æ©Ÿæœƒ</button>
            </div>
            <div id="associated-opportunities-list" class="widget-content">
                </div>
        </div>

        <div class="dashboard-widget" style="margin-top: var(--spacing-6);">
            <div class="widget-header">
                <h2 class="widget-title">åŒå…¬å¸æ½›åœ¨è¯çµ¡äºº</h2>
            </div>
            <div id="opp-potential-contacts-container" class="widget-content">
                </div>
        </div>

    </div>

    <div id="modal-container"></div>

    <script src="/scripts/core/theme-toggle.js"></script>
    <script src="/scripts/core/utils.js"></script>
    
    <script src="/scripts/services/api.js"></script>
    <script src="/scripts/services/ui.js"></script>
    
    <script src="/scripts/components/chip-wall.js"></script>

    <script src="/scripts/opportunities/details/opportunity-stepper.js"></script>
    <script src="/scripts/opportunities/details/opportunity-interactions.js"></script>
    <script src="/scripts/opportunities/details/opportunity-associated-contacts.js"></script>
    <script src="/scripts/opportunities/details/opportunity-event-reports.js"></script>
    <script src="/scripts/opportunities/details/opportunity-info-view.js"></script>
    <script src="/scripts/opportunities/details/opportunity-details-components.js"></script>
    
    <script src="/scripts/opportunities/opportunity-details-events.js"></script>
    <script src="/scripts/opportunities/opportunity-details.js"></script>
    <script src="/scripts/opportunities/opportunity-modals.js"></script>

    <script src="/scripts/events/event-modal-manager.js"></script>
    <script src="/scripts/events/event-editor-standalone.js"></script>

</body>
</html>