<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>FANUCforce æ½›åœ¨å®¢æˆ¶åç‰‡ç¸½è¦½</title>
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    
    <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    
    <link rel="stylesheet" href="styles/modules/variables.css">
    <link rel="stylesheet" href="styles/leads-view.css">
    
    <style>
        /* --- å‹•ç•«å®šç¾© (å¾©åˆ» CRM ç³»çµ±ç‰¹æ•ˆ) --- */

        /* 1. æƒå…‰å‹•ç•« (Shine) - æ¨¡æ“¬åå…‰æƒéè¡¨é¢ */
        @keyframes btn-shine {
            0% { left: -100%; opacity: 0; }
            20% { left: 100%; opacity: 0.5; } /* å…‰æŸæƒé */
            100% { left: 100%; opacity: 0; } /* åœç•™ */
        }

        /* 2. å‘¼å¸ç‡ˆé™°å½±å‹•ç•« (Pulse) - æ¨¡æ“¬ç´«è‰²å…‰æšˆå‘¼å¸ */
        @keyframes btn-pulse-glow {
            0% { 
                box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05); /* åˆå§‹ï¼šå¾®å¼±é™°å½± */
                border-color: #cbd5e1; /* åˆå§‹ï¼šæ·¡ç°é‚Šæ¡† */
            }
            50% { 
                /* å‘¼å¸é ‚é»ï¼šæ˜é¡¯çš„ç´«è‰²å…‰æšˆ + é‚Šæ¡†è®Šè‰² */
                box-shadow: 0 0 15px rgba(139, 92, 246, 0.6); 
                border-color: rgba(139, 92, 246, 0.8);
            }
            100% { 
                box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05); 
                border-color: #cbd5e1;
            }
        }

        /* --- Line Bot æŒ‰éˆ•æ¨£å¼ --- */
        .line-bot-link {
            position: relative; /* ç‚ºäº†å®šä½æƒå…‰å½å…ƒç´  */
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            
            /* åŸºç¤æ¨£å¼ï¼šç™½åº•ã€æ·±ç°å­— */
            background-color: #ffffff;
            color: #334155; 
            border: 1px solid #cbd5e1;
            
            text-decoration: none;
            padding: 12px;
            border-radius: 12px;
            font-weight: 700;
            font-size: 1rem;
            margin-bottom: 16px;
            
            box-sizing: border-box;
            overflow: hidden; /* ç¢ºä¿å…‰æŸä¸æœƒè¶…å‡ºæŒ‰éˆ•ç¯„åœ */
            transition: transform 0.1s ease;
            
            /* å¥—ç”¨å‘¼å¸ç‡ˆå‹•ç•«ï¼š3ç§’å¾ªç’°ä¸€æ¬¡ */
            animation: btn-pulse-glow 3s infinite ease-in-out;
        }

        /* æƒå…‰å±¤ (::after å½å…ƒç´ ) */
        .line-bot-link::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 50%;
            height: 100%;
            /* æƒå…‰é¡è‰²ï¼šæ·¡ç´«è‰²åŠé€æ˜å…‰æŸ */
            background: linear-gradient(
                to right,
                transparent 0%,
                rgba(139, 92, 246, 0.2) 50%, 
                transparent 100%
            );
            transform: skewX(-25deg); /* å‚¾æ–œå…‰æŸ */
            pointer-events: none;
            /* å¥—ç”¨æƒå…‰å‹•ç•«ï¼š4ç§’å¾ªç’°ä¸€æ¬¡ */
            animation: btn-shine 4s infinite linear;
        }
        
        /* é»æ“Šæ™‚å¾®ç¸®æ•ˆæœ */
        .line-bot-link:active {
            transform: scale(0.98);
            background-color: #f8fafc; /* é»æ“Šæ™‚ç¨å¾®è®Šç° */
        }

        .line-bot-link .icon {
            font-size: 1.2rem;
            margin-right: 8px;
            z-index: 1;
        }
        
        /* é¿å…èˆ‡ç¾æœ‰æ¨£å¼è¡çª */
        .controls-section {
            display: flex;
            flex-direction: column;
        }
    </style>

    <script>
        const LIFF_ID = '2008584585-8OQnm0Gk'; 
    </script>
</head>
<body>
    <div class="app-container">
        <header class="main-header">
            <a href="/dashboard.html" class="logo-area" style="text-decoration: none;">
                <img src="images/logo-full.svg" alt="FATDX" class="logo-img" onerror="this.style.display='none'; this.nextElementSibling.style.display='block'">
                <span class="logo-text" style="display:none; font-weight:800; font-size:1.2rem; color:var(--text-primary);">FATDX CRM</span>
            </a>
            
            <div class="user-area" id="user-area" style="display: none;">
                <span class="user-name" id="user-name">è¼‰å…¥ä¸­...</span>
                <img id="user-avatar" class="user-avatar" src="" alt="User">
            </div>
            <button id="login-btn" class="login-btn" style="display: none;">LINE ç™»å…¥</button>
        </header>

        <div class="controls-section">
            
            <a href="https://line.me/R/ti/p/@302winpe" target="_blank" class="line-bot-link">
                <span class="icon">ğŸ“¸</span> 
                <span>æƒæåç‰‡</span>
            </a>

            <div class="search-bar">
                <input type="text" id="search-input" placeholder="ğŸ” æœå°‹å§“åã€å…¬å¸ã€è·ç¨±...">
                <button id="clear-search" class="clear-btn" style="display: none;">âœ•</button>
            </div>
            
            <div class="view-toggle">
                <button class="toggle-btn active" data-view="all">
                    ğŸ¢ å…¨éƒ¨ <span id="count-all" class="count-badge">0</span>
                </button>
                <button class="toggle-btn" data-view="mine">
                    ğŸ‘¤ æˆ‘çš„ <span id="count-mine" class="count-badge">0</span>
                </button>
            </div>
        </div>

        <main class="leads-container">
            <div id="loading-indicator" class="loading-state">
                <div class="spinner"></div>
                <p>æ­£åœ¨åŒæ­¥åç‰‡è³‡æ–™...</p>
            </div>
            
            <div id="leads-grid" class="leads-grid" style="display: none;">
                </div>
            
            <div id="empty-state" class="empty-state" style="display: none;">
                <div class="empty-icon">ğŸ“‡</div>
                <p>æ²’æœ‰æ‰¾åˆ°ç¬¦åˆçš„åç‰‡</p>
            </div>
        </main>
    </div>

    <div id="preview-modal" class="modal">
        <div class="modal-content preview-content">
            <span class="close-modal">&times;</span>
            <div id="preview-image-container">
                <div class="spinner"></div>
            </div>
            <a id="preview-download-link" href="#" target="_blank" class="download-link">åœ¨æ–°è¦–çª—é–‹å•ŸåŸåœ–</a>
        </div>
    </div>

    <div id="edit-modal" class="modal">
        <div class="modal-content edit-content">
            <div class="modal-header">
                <h3>âœï¸ ç·¨è¼¯åç‰‡</h3>
                <span class="close-modal">&times;</span>
            </div>
            <form id="edit-form">
                <input type="hidden" id="edit-rowIndex">
                <div class="form-group">
                    <label>å§“å</label>
                    <input type="text" id="edit-name" class="form-input" required>
                </div>
                <div class="form-group">
                    <label>è·ç¨±</label>
                    <input type="text" id="edit-position" class="form-input">
                </div>
                <div class="form-group">
                    <label>å…¬å¸</label>
                    <input type="text" id="edit-company" class="form-input" required>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>æ‰‹æ©Ÿ</label>
                        <input type="tel" id="edit-mobile" class="form-input">
                    </div>
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" id="edit-email" class="form-input">
                    </div>
                </div>
                <div class="form-group">
                     <label>å‚™è¨» (å°‡é™„åŠ æ–¼ç¾æœ‰å‚™è¨»å¾Œ)</label>
                     <textarea id="edit-notes" class="form-input" rows="3"></textarea>
                </div>
                <button type="submit" class="save-btn">å„²å­˜è®Šæ›´</button>
            </form>
        </div>
    </div>

    <script src="scripts/core/utils.js"></script>
    <script src="scripts/services/api.js"></script>
    <script src="scripts/services/ui.js"></script>
    
    <script src="scripts/leads-view.js"></script>
</body>
</html>